//
// These are the styles for when
// we display the conference schedule.
//

// Include our settings.
@import "settings";

// Include our mixins.
@import "mixins";

.clear {
	clear: both;
}

@include include-schedule-links();

#conf-sch-single-livestream {
	margin: 1.5rem 0;
	
	.underline {
		text-decoration: underline;
	}

	a {
		display: block;
		background-color: $video-color;
		color: #fff !important;
		padding: 15px 20px;
		text-align: center;
		border-radius: 5px;
		text-decoration: none;
		@include set-transition( background-color 1s ease );

		&:focus,
		&:hover {
			background-color: darken( $video-color, 10% );
		}
	}
}

#conf-sch-single-content {
	clear: left;
	
	.conf-schedule-single-loading,
    .conf-schedule-single-error {
	    font-style: italic;
    }

	.conf-schedule-single-error {
		color: #900;
	}

	.conf-sch-group-events {

		.conf-sch-group-event {
			border-top: 1px solid #eee;
			margin: 2rem 0 0 0;
			padding: 2.1rem 0 0 0;

			*:first-child {
				margin-top: 0;
			}

			*:last-child {
				margin-bottom: 0;
			}

			.event-time {
				font-size: 0.9rem;
				color: #666;
			}

			.event-title {
				font-size: 1.5rem;
				line-height: 2.3rem;
				margin: 0;
			}

			.event-subjects {
				margin: 0.4rem 0 0 0;
				font-style: italic;
			}

			.event-speakers {
				font-weight: 700;
				font-size: 1.2rem;
				line-height: 1.3;
				margin: 0.4rem 0 0 0;
			}

			.event-excerpt {
				margin: 0.8rem 0 1.2rem 0;

				* {
					font-size: 0.9rem;
					line-height: 1.8;
				}
			}

			.event-links {
				margin: 0.6rem 0 0 0;
			}

			&:first-child {
				border-top: 0;
				margin-top: 0;
				padding-top: 0;
			}
		}
	}

	@media screen and (min-width: 620px) {

		.callout {

			&.with-meta {
				margin-right: 370px;
			}

			&:first-child {
				margin-top: 45px;
			}
		}
	}
}

// Customize the single schedule pages
#conf-sch-single-meta {
	background: #fff;
	border: 1px solid #e8e8e8;
	border-radius: 5px;
	margin: 15px 0 30px 0;
	padding: 20px;
	font-size: 1em;
	line-height: 1.6em;

	.event-meta {
		display: block;
		margin: 0 0 5px 0;

		&.event-subjects .event-meta-value {
			font-style: italic;
		}
	}

	.event-meta-label {
		font-weight: bold;
	}

	.conf-sch-event-buttons {
		margin: 12px 0 0 0 !important;
	}

	*:first-child {
		margin-top: 0 !important;
	}

	// Move meta to the right when screen gets larger
	@media screen and (min-width: 620px) {
		float: right;
		margin-left: 30px;
		min-width: 300px;
		max-width: 350px;
	}
}

// Customize the video on the single schedule pages
$session-video-height: 450px;
#conf-sch-single-video {
	display: none;
	width: 100%;
	margin: 0 0 20px 0;

	iframe {
		width: 100%;
		height: $session-video-height;
	}
}

#conf-sch-single-speakers {
	display: none;
	clear: both;

	@include include-schedule-speaker();

	&.conf-schedule-speakers {

		.conf-schedule-speaker {

			.speaker-headshot {
				margin-top: 15px;
			}

			.speaker-name {
				margin: 0 0 10px 0;
			}
		}
	}
}

// Set schedule variables
$conf-sch-time-width: 15%;
$conf-sch-events-width: 85%;
.conference-schedule-container {
	box-sizing: border-box;

	* {
		box-sizing: border-box;
	}

	.schedule-table {
		margin: 20px 0 30px 0;

		.schedule-header-row {
			display: none;
		}

		.schedule-row {
			clear: both;
			overflow: auto;
			padding: 0 0 25px 0;
			border-top: 5px solid $schedule-border-color;

			&:last-child {
				border-bottom: 1px solid $schedule-border-color;
			}

			.schedule-event {
				overflow: visible;
				margin: 0 0 25px 0;

				.event-time {
					display: block;
				}

				.event-title {
					font-weight: bold;
					margin: 0;
					font-size: 1.2em;
					line-height: 1.4;
					text-transform: none;
				}

				.event-excerpt,
				.event-format,
				.event-location,
				.event-address {
					display: block;
					margin: 5px 0 0 0;
					font-size: 0.95em;
					line-height: 1.3;
					opacity: 0.8;

					a {
						color: inherit;
					}
				}

				.event-excerpt {
					background: rgba($wpc-royal-blue,0.05);
					padding: 10px;
					margin-top: 15px;

					*:first-child {
						margin-top: 0;
					}

					*:last-child {
						margin-bottom: 0;
					}
				}

				.event-format {
					font-style: italic;
				}

				.event-subjects {
					font-style: italic;
					margin: 4px 0;
					line-height: 1.6rem;
				}

				.event-speakers {
					font-size: 1.1em;
					line-height: 1.4;
					color: #222;
					font-weight: bold;
					margin: 3px 0 0 0;
				}

				.conf-sch-event-buttons {

					li {
						display: block;
						margin: 5px 0 0 0;
					}
				}

				& > *:last-child {
					margin-bottom: 0;
				}

				// If it's a parent
				&.event-parent {

					.event-children {
						border-top: 1px solid $schedule-border-color;
						margin: 25px 0 0 0;

						.schedule-event {

							.event-time {
								display: block !important;
								font-size: 0.9em;
								line-height: 1.7;
							}
						}

						// When gets broken into columns.
						@media screen and (min-width: $schedule-table-col-breakpoint) {
							display: flex;
							
							&.has-same-time {
								.event-time {
									display: none !important;
								}
							}

							&.has-same-location {
								.event-location {
									display: none !important;
								}
							}
						}
					}
				}
			}

			.schedule-row-item {
				display: block;
				clear: both;
				background: none;
				position: relative;
				border-top: 1px solid $schedule-border-color;
				padding: 0;

				.schedule-event {
					padding: 25px 0 0 0;
				}

				&.time {
					display: none;
				}

				&.events {

					.schedule-event:last-child {
						margin-bottom: 0;
					}
				}
			}

			&.status-in-progress {
				background: rgba( $in-progress-color, 0.05 );
				border-top: 5px solid rgba( $in-progress-color, 0.3 );
				border-bottom: 5px solid rgba( $in-progress-color, 0.3 );
				
				// Only tweak for small screens.
				@media screen and (max-width: $schedule-table-col-breakpoint - 1) {
					padding-bottom: 20px;
				
					.schedule-row-item {
						padding-left: 10px;
						padding-right: 10px;
						
						.schedule-event {
							padding-top: 20px;
							margin-bottom: 5px;
						}
					}	
				}
			}

			&.status-in-progress + .schedule-row {
				border-top: 0;
			}

			&.status-past {
				opacity: 0.5;
			}

			//&.status-future {}
		}

		.schedule-row.current + .schedule-row {

			.schedule-row-item {
				border-top: 0;
			}
		}
	}

	.conference-schedule {
		opacity: 1;
		@include set-transition( opacity 1s ease );

		.schedule-by-day {
			margin-top: 0;

			&.schedule-in-past {

				&.schedule-show {

					.status-past {
						opacity: 1;
					}
				}

				&:not(.schedule-show) {

					.schedule-row.status-past {
						display: none;
					}
				}
			}

			& + .schedule-by-day {
				margin-top: -10px;
			}
		}
	}

	.schedule-nav-buttons {

		button,
		.button {
			@include is-button();

			&.highlight {
				background-color: $wpc-royal-blue;
				color: #fff;

				&.schedule-video  {
					background-color: $video-color;
				}

				&.schedule-go-current {
					background-color: $in-progress-color;
				}
			}

			& + button,
			& + .button {
				margin-top: -0.7rem;
			}
		}

		@media screen and (min-width: 600px) {
			display: flex;
			flex-wrap: wrap;
			margin: 1.3rem 0;

			button,
			.button {
				margin: 5px !important;
			}

			&.nav-top {
				border-bottom: 1px solid $schedule-border-color;
				padding-bottom: 1.3rem;
			}

			&.nav-bottom {

				button,
				.button {
					width: 48%;
					flex: auto;
					margin: 5px 1%;
				}
			}

			&.has-highlight {

				button,
				.button {
					flex: 1;

					&.highlight {
						width: 100%;
						flex: auto;
					}
				}
			}
		}

		@media screen and (min-width: $schedule-table-col-breakpoint) {

			&.nav-top {

				button,
				.button {
					flex: 1 !important;
					width: auto !important;
				}
			}

			&.nav-bottom {

				button,
				.button {
					width: auto !important;

					&:first-child {
						margin-left: 0 !important;
					}

					&:last-child {
						margin-right: 0 !important;
					}
				}
			}
		}
	}

	$side-buttons-width: 60px;
	$side-buttons-height: 60px;
	.schedule-side-buttons {
		position: fixed;
		right: 0;
		top: 70px;
		width: $side-buttons-width;
		opacity: 0;
		pointer-events: none;
		z-index: 1000;
		@include set-transition(opacity 1s ease);

		button,
		.button {
			@include is-button();
			width: $side-buttons-width;
			height: $side-buttons-height;
			border-top-right-radius: 0;
			border-bottom-right-radius: 0;
			margin: 10px 0;

			span {
				@include for-screen-reader();
			}

			&.schedule-refresh {
				background: url('../../images/refresh.svg') center center no-repeat rgba(0,0,0,0.1);
				background-size: 28px auto;
			}

			&.schedule-video {
				background: url('../../images/video.svg') center center no-repeat rgba(0,0,0,0.1);
				background-size: 32px auto;
			}

			&.schedule-go-current {
				background: url('../../images/clock.svg') center center no-repeat rgba(0,0,0,0.1);
				background-size: 32px auto;
			}

			&.schedule-go-top {
				background: url('../../images/arrow-up.svg') center center no-repeat rgba(0,0,0,0.1);
				background-size: 32px auto;
			}

			&.highlight {
				background-color: rgba($wpc-royal-blue, 0.1);

				&.schedule-video  {
					background-color: rgba($video-color, 0.1);
				}

				&.schedule-go-current {
					background-color: rgba($in-progress-color, 0.1);
				}
			}
		}
	}

	.conference-schedule-pre,
	.conference-schedule-post {
		opacity: 1;
		@include set-transition( opacity 1s ease );
	}

	.conference-schedule-loading {
		pointer-events: none;
		opacity: 0;
		@include set-transition( opacity 1s ease );
	}

	&.active {

		.schedule-side-buttons {
			opacity: 1;
			pointer-events: auto;
		}
	}

	$loading-opacity: 0.2;
	$loading-min-height: 100px;
	&.loading {
		min-height: $loading-min-height;
		position: relative;
		pointer-events: none;

		.conference-schedule {
			opacity: $loading-opacity;
			pointer-events: none;
		}

		.conference-schedule-pre,
		.conference-schedule-post {
			opacity: $loading-opacity;
			pointer-events: none;
		}

		.schedule-side-buttons {
			opacity: $loading-opacity;
			pointer-events: none;
		}

		.conference-schedule-loading {
			opacity: 1;
			min-height: $loading-min-height;
			position: absolute;
			left: 0;
			top: 0;
			width: 100%;
			height: 100%;
			background: url('../../images/loading.gif') center center no-repeat;
			z-index: 1000;
		}
	}
}

/*.collapsible-schedule-block {
    display : block;
    clear: both;
    border-radius: 5px;
    padding: 0;
    margin: 0 -10px 30px -10px;
    overflow: hidden;

    .schedule-header {
        background: rgba( #000, 0.04 );
        margin: 0;
        padding: 10px;
        position: relative;
        z-index: 0;
        cursor: pointer;

        &:before {
            content: 'View';
            position: absolute;
            right: 15px;
            top: 50%;
            margin: -9px 0 0 0;
            font-size: 15px;
            line-height: 1.2;
            font-weight: normal;
            text-transform: uppercase;
            cursor: pointer;
            z-index: -1;
        }
    }

    .schedule-table {
        display: none;
    }

    &.open {

        .schedule-header {

            &:before {
                content: 'Close';
            }
        }

        .schedule-table {
            display: block;
            margin: 0;
            padding: 0;
        }
    }
}*/

// Tweak the schedule page
/*body.page-template-schedule {

    .schedule-main-buttons-wrapper {
        margin: -10px 0 30px 0;

        .btn {
            font-size: 20px;
            line-height: 1.7;
            text-decoration: none;
            margin: 0;
        }

        .btn.conference-eval {
            display: block;
            width: 100%;
        }

        .btn.go-to-current-event {
            display: none; // Hide by default
            background: $heweb-blue;
            width: 100%;
            border: 0;
            text-transform: uppercase;

			&:focus,
            &:hover {
                background: darken($heweb-blue, 8%);
            }
        }

        .btn.go-to-current-event + .schedule-header {
            margin-top: 0 !important;
        }

        &.has-go-to-event {

            .btn + .btn {
                margin-top: 10px;
            }
        }
    }
}*/

// Screens larger than 600px
@media screen and (min-width: 600px) {

	/*// Tweak the schedule page
	body.page-template-schedule {

		.schedule-main-buttons-wrapper {
			margin: -10px 0 15px 0;
			font-size: 16px;
			line-height: 1.7;
			overflow: auto;

			.btn {
				margin: 0 !important;

				&.go-to-current-event {
					width: auto;
					float: right;
					margin-left: 20px !important;
				}
			}

			&.has-go-to-event {

				.btn.conference-eval {
					width: auto;
					float: left;
				}
			}
		}
	}*/
}

// Screens larger than 1000px get broken into columns
@media screen and (min-width: $schedule-table-col-breakpoint) {

	.conference-schedule-container {

		.schedule-table {

			.schedule-header-row {
				display: block;
				clear: both;
				overflow: auto;
				background: #f6f6f6;
				padding: 10px 0;
				text-transform: uppercase;
				opacity: 0.8;
				font-size: 0.9em;
				line-height: 1.1;

				.schedule-header-item {
					display: block;
					clear: none;
					float: left;

					&.time {
						display: block;
						width: $conf-sch-time-width;
						padding: 0 10px;
					}

					&.events {
						width: $conf-sch-events-width;

						.schedule-header-event {
							padding: 0 10px;

							// Two and four items
							&:first-child:nth-last-child(2),
							&:first-child:nth-last-child(2) ~ .schedule-header-event,
							&:first-child:nth-last-child(4),
							&:first-child:nth-last-child(4) ~ .schedule-header-event {
								float: left;
								width: 50%;
							}

							// Three items
							&:first-child:nth-last-child(3),
							&:first-child:nth-last-child(3) ~ .schedule-header-event {
								float: left;
								width: 33.3333%;
							}

							&:first-child {
								padding-left: 0;
							}
						}
					}
				}
			}

			.schedule-row {
				border-top: 0;

				&:last-child {
					border-bottom: 1px solid $schedule-border-color !important;
				}

				/*&.current {
					background: rgba( #f9ff00, 0.2 );

					&:before {
						display: none;
					}

				}*/

				.schedule-event {
					margin-bottom: 0;
					position: relative;

					.event-time {
						display: none;
					}

					&.has-event-links {
						.event-links {
							position: absolute;
							left: 0;
							bottom: 0;
							width: 100%;
						}
					}

					$event-link-padding-base: 60px;
					$event-link-padding-inc: 45px;
					@for $i from 1 through 20 {
						&.has-event-links-#{$i} {
							@if $i > 1 {
								padding-bottom: $event-link-padding-base + ($event-link-padding-inc * ($i - 1));
							} @else {
								padding-bottom: $event-link-padding-base;
							}
						}
					}
				}

				.schedule-row-item {
					display: block;
					clear: none;
					float: left;
					border-top: 1px solid $schedule-border-color !important;

					&.time {
						display: block;
						width: $conf-sch-time-width;
						font-size: 0.8em;
						line-height: 1.7;
						padding: 25px 10px 10px 10px;
						margin: 0;
						opacity: 0.9;
					}

					&.events {
						display: flex;
						width: $conf-sch-events-width;
						position: relative;

						.schedule-event {
							width: 100%;
							padding-right: 10px;
							padding-left: 10px;
							min-height: 1px;

							.event-links {
								padding-right: 10px;
								padding-left: 10px;
							}

							// Two and four items
							&:first-child:nth-last-child(2),
							&:first-child:nth-last-child(2) ~ .schedule-event,
							&:first-child:nth-last-child(4),
							&:first-child:nth-last-child(4) ~ .schedule-event {
								width: 50%;
							}

							// Three items
							&:first-child:nth-last-child(3),
							&:first-child:nth-last-child(3) ~ .schedule-event {
								width: 33.3333%;
							}

							&:first-child {
								padding-left: 0;

								.event-links {
									padding-left: 0;
								}
							}
						}
					}
				}
			}
		}
	}
}
