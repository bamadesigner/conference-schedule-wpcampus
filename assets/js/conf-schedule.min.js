!function($){"use strict";var $conf_sch_templ=!1,$conf_schedule=null,$conf_sch_container=null;$(document).ready(function(){$conf_schedule=$("#conference-schedule"),$conf_sch_container=$("#conference-schedule-container");var $conf_sch_templ_content=$("#conference-schedule-template").html();void 0!==$conf_sch_templ_content&&$conf_sch_templ_content&&($conf_sch_templ=Handlebars.compile($conf_sch_templ_content),function(){var apiURL=conf_sch.wp_api_route+"schedule";""!=$conf_sch_container.data("date")&&(apiURL+="?conf_sch_event_date="+$conf_sch_container.data("date"));var schedule_items=[],proposals={};$.ajax({url:apiURL,type:"GET",dataType:"json",cache:!1,success:function(the_schedule_items){if(void 0===the_schedule_items||""==the_schedule_items)return!1;schedule_items=the_schedule_items,$.ajax({url:conf_sch.ajaxurl,type:"GET",dataType:"json",cache:!1,asynce:!1,data:{action:"conf_sch_get_proposals"},success:function(the_proposals){if(void 0===the_proposals||""==the_proposals)return!1;$.each(the_proposals,function(index,proposal){proposal.id&&(proposals["proposal"+proposal.id]=proposal)})},complete:function(){if(!schedule_items)return!1;var $children_events=[],current_dt_local=new Date,utc_timezone_diff=current_dt_local.getTimezoneOffset()/60,local_hour_diff=(utc_timezone_diff=utc_timezone_diff>0?0-utc_timezone_diff:Math.abs(utc_timezone_diff))-parseInt(conf_sch.tz_offset),$schedule_html="",$schedule_by_dates={};$.each(schedule_items,function(index,item){if(item.event_parent>0)return $children_events.push(item),!0;var proposal=null;if("session"==item.event_type&&(item.proposal>0&&"proposal"+item.proposal in proposals&&(proposal=proposals["proposal"+item.proposal]),proposal&&"confirmed"==proposal.proposal_status?(proposal.title&&(item.title=proposal.title),item.content=proposal.content||{},item.excerpt=proposal.excerpt||{},item.speakers=proposal.speakers||[],item.subjects=proposal.subjects||[]):(item.title.rendered="TBA",item.content={},item.excerpt={},item.proposal=0,item.speakers=[],item.subjects=[],item.link_to_post=!1)),void 0===item.event_date||!item.event_date)return!0;if(void 0===item.event_start_time||!item.event_start_time)return!0;var $event_time_index=item.event_start_time;item.event_end_time&&($event_time_index+=":"+item.event_end_time),void 0===$schedule_by_dates[item.event_date]&&($schedule_by_dates[item.event_date]={}),void 0===$schedule_by_dates[item.event_date][$event_time_index]&&($schedule_by_dates[item.event_date][$event_time_index]={event_date:item.event_date,start_time:item.event_start_time,end_time:item.event_end_time,events:[]}),$schedule_by_dates[item.event_date][$event_time_index].events.push(item)}),$.each($schedule_by_dates,function($date,$day_by_time){var $schedule_day_html="",$day_display="",event_in_progress=!1;$.each($day_by_time,function($time,$time_items){if(void 0===$time_items.events||"object"!=typeof $time_items.events||0==$time_items.events.length)return!0;var $row_time_display="",$row_events=[];if($.each($time_items.events,function(index,item){""==$day_display&&item.event_date_display&&($day_display=item.event_date_display),""==$row_time_display&&item.event_time_display&&($row_time_display=item.event_time_display),$row_events.push($conf_sch_templ(item))}),$row_events.length>=1){var row_date_pieces=null!==$time_items.event_date&&$time_items.event_date.search("-")>-1?$time_items.event_date.split("-"):[],row_start_time_pieces=null!==$time_items.start_time&&$time_items.start_time.search(":")>-1?$time_items.start_time.split(":"):[],row_end_time_pieces=null!==$time_items.end_time&&$time_items.end_time.search(":")>-1?$time_items.end_time.split(":"):[],row_start_dt_year=parseInt(row_date_pieces[0]),row_start_dt_month=parseInt(row_date_pieces[1])-1,row_start_dt_day=parseInt(row_date_pieces[2]),row_start_hour=parseInt(row_start_time_pieces[0])+local_hour_diff,row_start_minute=parseInt(row_start_time_pieces[1]),row_start_dt=new Date(row_start_dt_year,row_start_dt_month,row_start_dt_day,row_start_hour,row_start_minute),row_start_dt_delay=new Date(row_start_dt.valueOf());void 0!==conf_sch.reveal_delay&&row_start_dt_delay.setSeconds(row_start_dt_delay.getSeconds()-parseInt(conf_sch.reveal_delay));var row_end_dt=null;if(row_end_time_pieces.length>1){var row_end_hour=parseInt(row_end_time_pieces[0])+local_hour_diff,row_end_minute=parseInt(row_end_time_pieces[1]);row_end_dt=new Date(row_start_dt_year,row_start_dt_month,row_start_dt_day,row_end_hour,row_end_minute)}var schedule_row_status="";null!==row_end_dt&&(row_start_dt_delay<current_dt_local&&current_dt_local<row_end_dt?(schedule_row_status="status-in-progress",event_in_progress=!0):schedule_row_status=current_dt_local>=row_end_dt?"status-past":"status-future");var $schedule_row_html='<div class="schedule-row-item time">'+$row_time_display+"</div>";$schedule_row_html+='<div class="schedule-row-item events">'+$row_events.join("")+"</div>",$schedule_day_html+=$schedule_row_html='<div class="schedule-row '+schedule_row_status+'">'+$schedule_row_html+"</div>"}}),$schedule_day_html='<h2 class="schedule-header">'+$day_display+"</h2>"+($schedule_day_html='<div class="schedule-table">'+$schedule_day_html+"</div>");var day_class="schedule-by-day";event_in_progress&&(day_class+=" schedule-in-progress"),$schedule_html+=$schedule_day_html='<div class="'+day_class+'">'+$schedule_day_html+"</div>"}),$conf_schedule.html($schedule_html),$children_events.length>=1&&$.each($children_events,function(index,item){var $event_parent=$("#conf-sch-event-"+item.event_parent);if($event_parent.length>0){$event_parent.addClass("event-parent");var $event_children=$event_parent.find(".event-children");0==$event_children.length&&($event_children=$('<div class="event-children"></div>').appendTo($event_parent)),$event_children.append($conf_sch_templ(item))}});var $scheduleNavButtonsTop=$('<div class="schedule-nav-buttons nav-top has-highlight"></div>'),$watchSession=$('<a class="schedule-nav-button highlight" href="'+conf_sch.watch_url+'">'+conf_sch.watch_message+"</a>");$scheduleNavButtonsTop.append($watchSession);var $inProgress=$("#conference-schedule .schedule-row.status-in-progress:first");if($inProgress.length>0){var $jumpSession=$('<button class="schedule-nav-button schedule-jump">'+conf_sch.jump_message+"</button>");$scheduleNavButtonsTop.append($jumpSession)}var $viewSpeakers=$('<a class="schedule-nav-button" href="'+conf_sch.speakers_url+'">'+conf_sch.speakers_message+"</a>");$scheduleNavButtonsTop.append($viewSpeakers);var $scheduleNavButtonsBottom=$scheduleNavButtonsTop.clone().removeClass("nav-top has-highlight").addClass("nav-bottom"),$goToTop=$('<button class="schedule-nav-button schedule-top">'+conf_sch.top_message+"</button>");$scheduleNavButtonsBottom.append($goToTop),$scheduleNavButtonsTop.insertAfter($("#conference-schedule .schedule-by-day:first .schedule-header")),$conf_schedule.append($scheduleNavButtonsBottom),$("#conference-schedule .schedule-jump").on("click",function(e){e.preventDefault(),$("html, body").animate({scrollTop:$inProgress.offset().top},500,function(){$inProgress.find("*:tabbable:first").focus()})}),$("#conference-schedule .schedule-top").on("click",function(e){e.preventDefault();var $theSchedule=$("#conference-schedule");$theSchedule.length>0&&$("html, body").animate({scrollTop:$theSchedule.offset().top},500,function(){$theSchedule.find("*:tabbable:first").focus()})}),$conf_sch_container.children().fadeOut(),$conf_sch_container.removeClass("loading"),$conf_sch_container.children().fadeIn(1e3)}})}})}())}),Handlebars.registerHelper("title",function($options){var $new_title=this.title.rendered;return void 0!==$new_title&&$new_title?(this.link_to_post&&void 0!==this.link&&this.link&&($new_title='<a href="'+this.link+'">'+$new_title+"</a>"),new Handlebars.SafeString('<h3 class="event-title">'+$new_title+"</h3>")):null}),Handlebars.registerHelper("excerpt",function($options){var $new_excerpt=this.excerpt.rendered;return void 0!==$new_excerpt&&$new_excerpt?new Handlebars.SafeString('<div class="event-desc">'+$new_excerpt+"</div>"):null}),Handlebars.registerHelper("social_media",function($options){var social_string="";return void 0!==this.speakers&&this.speakers&&this.speakers.length>0&&$.each(this.speakers,function(index,value){void 0!==value.twitter&&value.twitter&&(social_string+='<li class="event-link event-twitter"><a href="https://twitter.com/'+value.twitter+'"><i class="conf-sch-icon conf-sch-icon-twitter"></i> <span class="icon-label">@'+value.twitter+"</span></a></li>")}),social_string?new Handlebars.SafeString('<ul class="conf-sch-event-buttons conf-sch-social-buttons">'+social_string+"</ul>"):null}),Handlebars.registerHelper("event_links",function($options){var event_links_string="";return void 0!==conf_sch.view_livestream&&""!=conf_sch.view_livestream&&void 0!==this.session_livestream_url&&this.session_livestream_url&&(event_links_string+='<li class="event-link event-livestream"><a href="'+this.session_livestream_url+'">'+conf_sch.view_livestream+"</span></a></li>"),void 0!==conf_sch.watch_video&&""!=conf_sch.watch_video&&void 0!==this.session_video_url&&this.session_video_url&&(event_links_string+='<li class="event-link event-video"><a href="'+this.session_video_url+'">'+conf_sch.watch_video+"</span></a></li>"),void 0!==conf_sch.give_feedback&&""!=conf_sch.give_feedback&&void 0!==this.session_feedback_url&&this.session_feedback_url&&(event_links_string+='<li class="event-link event-feedback"><a href="'+this.session_feedback_url+'">'+conf_sch.give_feedback+"</span></a></li>"),void 0!==conf_sch.view_slides&&""!=conf_sch.view_slides&&void 0!==this.session_slides_url&&this.session_slides_url&&(event_links_string+='<li class="event-link event-slides"><a href="'+this.session_slides_url+'">'+conf_sch.view_slides+"</span></a></li>"),event_links_string?new Handlebars.SafeString('<ul class="conf-sch-event-buttons">'+event_links_string+"</ul>"):null})}(jQuery);